<?php    class review {		var $id = 0;		var $user_id = 0;		var $text = '';		var $item_id = 0;		var $moderate = 0;        var $time_add = '';                var $user_class = false;        var $item_class = false;		function __construct($id = false) {			if ($id) 				$this->load_review($id);		}		function get_id() {			return (int)$this->id;		}		function set_id($id) {			$this->id = (int)$id;		}		function get_user_id() {			return (int)$this->user_id;        }                function get_user() {            if (!$this->user_class) {                $this->user_class = new user($this->get_user_id());            }            return $this->user_class;        }		function set_user_id($user_id) {            $this->user_class = false;			$this->user_id = (int)$user_id;		}		function get_text() {			return strip_tags($this->text);		}		function set_text($text) {			$this->text = strip_tags(db()->nomysqlinj($text));		}		function get_item_id() {			return (int)$this->item_id;        }                function get_item() {            if (!$this->item_class) {                $this->item_class = new droppedItem($this->get_item_id());            }            return $this->item_class;        }		function set_item_id($item_id) {            $this->item_class = false;			$this->item_id = (int)$item_id;		}		function get_moderate() {			return $this->moderate? true : false;		}		function set_moderate($moderate) {			$this->moderate = $moderate? 1 : 0;		}		function get_time_add() {			return $this->time_add;        }                function get_format_time_add($format = 'd.m.Y H:i:s') {			return getdatetime($this->get_time_add(), $format);		}		function set_time_add($time_add) {			$this->time_add = $time_add;		}		function set_parametrs($id, $user_id, $text, $item_id, $moderate, $time_add) {			$this->set_id($id);			$this->set_user_id($user_id);			$this->set_text($text);			$this->set_item_id($item_id);			$this->set_moderate($moderate);			$this->set_time_add($time_add);		}		function set_parametrs_from_request() {			if (isset($_POST['user_id']))				$this->set_user_id($_POST['user_id']);			if (isset($_POST['text']))				$this->set_text($_POST['text']);			if (isset($_POST['item_id']))				$this->set_item_id($_POST['item_id']);			if (isset($_POST['moderate']))				$this->set_moderate($_POST['moderate']);			if (isset($_POST['time_add']))				$this->set_time_add($_POST['time_add']);		}		function clear_parametrs() {			$this->set_id(0);			$this->set_user_id(0);			$this->set_text('');			$this->set_item_id(0);			$this->set_moderate(0);			$this->set_time_add('');		}		function  load_review($id) {			$review =  selo('opencase_reviews', array('id' => $id));			$this->set_parametrs($review['id'], $review['user_id'], $review['text'], $review['item_id'], $review['moderate'], $review['time_add']);		}		function add_review() {			ins('opencase_reviews', array('user_id' => $this->get_user_id(), 'text' => $this->get_text(), 'item_id' => $this->get_item_id(), 'moderate' => $this->get_moderate()));		}		function update_review() {			upd('opencase_reviews', array('user_id' => $this->get_user_id(), 'text' => $this->get_text(), 'item_id' => $this->get_item_id(), 'moderate' => $this->get_moderate(), 'time_add' => $this->get_time_add()), array('id' => $this->get_id()));		}		function delete_review() {			del('opencase_reviews', array('id' => $this->get_id()));		}		static function get_reviews($where ='', $order = '', $limit = '') {			$reviewsArray = sel('opencase_reviews', $where, $order, $limit);			$reviews = array();			if (is_array($reviewsArray)) {				foreach ($reviewsArray as $reviewElement) {					$review = new review($reviewElement['id']);					array_push($reviews, $review);				}			}			return $reviews;		}	}?>